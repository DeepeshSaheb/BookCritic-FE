/*! For license information please see 126.51ad1969.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkbook_critic_fe=self.webpackChunkbook_critic_fe||[]).push([[126],{2330:(e,t,s)=>{var a=s(5043);var n="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},i=a.useState,r=a.useEffect,l=a.useLayoutEffect,o=a.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!n(e,s)}catch(a){return!0}}var d="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var s=t(),a=i({inst:{value:s,getSnapshot:t}}),n=a[0].inst,d=a[1];return l(function(){n.value=s,n.getSnapshot=t,c(n)&&d({inst:n})},[e,s,t]),r(function(){return c(n)&&d({inst:n}),e(function(){c(n)&&d({inst:n})})},[e]),o(s),s};t.useSyncExternalStore=void 0!==a.useSyncExternalStore?a.useSyncExternalStore:d},2356:(e,t,s)=>{s.d(t,{G:()=>i});var a=s(5043),n=s(579);const i=e=>{let{rating:t=0,maxRating:s=5,size:i="md",color:r="text-yellow-400",readOnly:l=!1,onChange:o,className:c=""}=e;const[d,m]=(0,a.useState)(0),x={sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"};return(0,n.jsx)("div",{className:"flex ".concat(c),onMouseLeave:()=>{l||m(0)},"aria-label":"Rating: ".concat(t," out of ").concat(s),children:Array.from({length:s},(e,a)=>{const c=a+1,u=d?c<=d:c<=t;return(0,n.jsx)("span",{className:"".concat(l?"":"cursor-pointer"),onMouseEnter:()=>{return e=c,void(l||m(e));var e},onClick:()=>{return e=c,void(!l&&o&&o(e));var e},role:l?void 0:"button",tabIndex:l?void 0:0,"aria-label":l?"Rating: ".concat(c," of ").concat(s):"Rate ".concat(c," of ").concat(s),children:u?(0,n.jsx)("svg",{className:"".concat(x[i]," ").concat(r),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,n.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}):(0,n.jsx)("svg",{className:"".concat(x[i]," text-gray-300"),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})})},a)})})}},7108:(e,t,s)=>{s.r(t),s.d(t,{AdminReviewsPage:()=>p});var a=s(5043),n=s(5604),i=s(9781),r=s(2836),l=s(709),o=s(383),c=s(1561),d=s(764),m=s(8964),x=s(2356),u=s(684),h=s(7386),g=s(579);const p=()=>{const{isAdmin:e}=(0,u.A)(),t=(0,i.jE)(),[s,p]=(0,a.useState)(1),[f,y]=(0,a.useState)(null),[v,j]=(0,a.useState)(!1),{data:b,isLoading:w,error:N}=(0,n.I)(["adminReviews",s],()=>h.z.getReviewsForModeration(10*(s-1),10),{keepPreviousData:!0,staleTime:3e5,enabled:e}),k=(0,r.n)(e=>h.z.approveReview(e),{onSuccess:()=>{t.invalidateQueries(["adminReviews"]),j(!1),y(null)},onError:e=>{alert((null===e||void 0===e?void 0:e.message)||"Failed to approve review. Please try again.")}}),C=(0,r.n)(e=>h.z.rejectReview(e),{onSuccess:()=>{t.invalidateQueries(["adminReviews"]),j(!1),y(null)},onError:e=>{alert((null===e||void 0===e?void 0:e.message)||"Failed to reject review. Please try again.")}}),R=e=>{k.mutate(e)},S=e=>{window.confirm("Are you sure you want to reject this review? This action cannot be undone.")&&C.mutate(e)},A=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return e?(0,g.jsx)(l.P,{children:(0,g.jsxs)(o.m,{className:"py-8",children:[(0,g.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Review Management"}),(0,g.jsx)("p",{className:"mt-2 text-lg text-gray-600",children:"Moderate reviews and manage reported content."}),(0,g.jsx)("div",{className:"mt-8 flex flex-col",children:(0,g.jsx)("div",{className:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8",children:(0,g.jsx)("div",{className:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8",children:(0,g.jsx)("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:w?(0,g.jsx)("div",{className:"flex justify-center py-12",children:(0,g.jsx)(c.y,{size:"lg"})}):N?(0,g.jsx)("div",{className:"p-6",children:(0,g.jsx)(d.F,{type:"error",children:"Failed to load reviews. Please try again later."})}):b&&b.reviews.length>0?(0,g.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[(0,g.jsx)("thead",{className:"bg-gray-50",children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6",children:"Book"}),(0,g.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"User"}),(0,g.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Rating"}),(0,g.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Date"}),(0,g.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Reports"}),(0,g.jsx)("th",{scope:"col",className:"relative py-3.5 pl-3 pr-4 sm:pr-6",children:(0,g.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),(0,g.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:b.reviews.map(e=>(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6",children:e.book.title}),(0,g.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.user.displayName}),(0,g.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:(0,g.jsx)(x.G,{rating:e.rating,readOnly:!0,size:"sm"})}),(0,g.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:A(e.createdAt)}),(0,g.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:(0,g.jsx)("span",{className:"inline-flex rounded-full px-2 text-xs font-semibold leading-5 ".concat(e.reportCount>5?"bg-red-100 text-red-800":e.reportCount>2?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:e.reportCount})}),(0,g.jsxs)("td",{className:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6",children:[(0,g.jsx)("button",{onClick:()=>(e=>{y(e),j(!0)})(e),className:"text-primary-600 hover:text-primary-900 mr-4",children:"View"}),(0,g.jsx)("button",{onClick:()=>R(e.id),className:"text-green-600 hover:text-green-900 mr-4",children:"Approve"}),(0,g.jsx)("button",{onClick:()=>S(e.id),className:"text-red-600 hover:text-red-900",children:"Reject"})]})]},e.id))})]}):(0,g.jsx)("div",{className:"p-6 text-center text-gray-500",children:"No reviews requiring moderation at this time."})})})})}),b&&b.total>10&&(0,g.jsx)("div",{className:"mt-6 flex justify-center",children:(0,g.jsx)(m.d,{currentPage:s,totalPages:Math.ceil(b.total/10),onPageChange:e=>{p(e)}})}),v&&f&&(0,g.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,g.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,g.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>j(!1)}),(0,g.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),(0,g.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",children:(0,g.jsx)("div",{className:"sm:flex sm:items-start",children:(0,g.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[(0,g.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Review Details"}),(0,g.jsxs)("div",{className:"mt-4",children:[(0,g.jsxs)("div",{className:"mb-4",children:[(0,g.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Book"}),(0,g.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:f.book.title})]}),(0,g.jsxs)("div",{className:"mb-4",children:[(0,g.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"User"}),(0,g.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:f.user.displayName})]}),(0,g.jsxs)("div",{className:"mb-4",children:[(0,g.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Rating"}),(0,g.jsx)("div",{className:"mt-1",children:(0,g.jsx)(x.G,{rating:f.rating,readOnly:!0})})]}),(0,g.jsxs)("div",{className:"mb-4",children:[(0,g.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Date"}),(0,g.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:A(f.createdAt)})]}),(0,g.jsxs)("div",{className:"mb-4",children:[(0,g.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Content"}),(0,g.jsx)("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-wrap",children:f.content})]}),(0,g.jsxs)("div",{className:"mb-4",children:[(0,g.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Report Count"}),(0,g.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:f.reportCount})]})]}),(0,g.jsxs)("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[(0,g.jsx)("button",{type:"button",onClick:()=>R(f.id),disabled:k.isLoading,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:k.isLoading?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.y,{size:"sm",color:"text-white",className:"mr-2"}),"Approving..."]}):"Approve"}),(0,g.jsx)("button",{type:"button",onClick:()=>S(f.id),disabled:C.isLoading,className:"mt-3 w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:C.isLoading?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.y,{size:"sm",color:"text-white",className:"mr-2"}),"Rejecting..."]}):"Reject"}),(0,g.jsx)("button",{type:"button",onClick:()=>j(!1),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Close"})]})]})})})]})})]})}):(0,g.jsx)(l.P,{children:(0,g.jsx)(o.m,{className:"py-12",children:(0,g.jsx)(d.F,{type:"error",children:"You do not have permission to access this page."})})})}},7386:(e,t,s)=>{s.d(t,{z:()=>n});var a=s(6291);const n={getUsers:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return a.A.get("/admin/users?skip=".concat(e,"&take=").concat(t))},getUserById:async e=>a.A.get("/admin/users/".concat(e)),updateUser:async(e,t)=>a.A.patch("/admin/users/".concat(e),t),deleteUser:async e=>a.A.delete("/admin/users/".concat(e)),getDashboardStats:async()=>a.A.get("/admin/dashboard/stats"),getReviewsForModeration:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return a.A.get("/admin/reviews/moderation?skip=".concat(e,"&take=").concat(t))},approveReview:async e=>a.A.post("/admin/reviews/".concat(e,"/approve")),rejectReview:async e=>a.A.post("/admin/reviews/".concat(e,"/reject"))}},8964:(e,t,s)=>{s.d(t,{d:()=>n});s(5043);var a=s(579);const n=e=>{let{currentPage:t,totalPages:s,onPageChange:n,className:i=""}=e;if(s<=1)return null;return(0,a.jsxs)("nav",{className:"flex items-center justify-between border-t border-gray-200 px-4 sm:px-0 py-3 ".concat(i),"aria-label":"Pagination",children:[(0,a.jsx)("div",{className:"hidden sm:block",children:(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing page ",(0,a.jsx)("span",{className:"font-medium",children:t})," of"," ",(0,a.jsx)("span",{className:"font-medium",children:s})]})}),(0,a.jsxs)("div",{className:"flex flex-1 justify-between sm:justify-end",children:[(0,a.jsx)("button",{onClick:()=>n(t-1),disabled:1===t,className:"relative inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,a.jsx)("div",{className:"hidden sm:flex sm:items-center",children:(0,a.jsx)("div",{className:"flex items-center space-x-1",children:(()=>{const e=[];e.push(1);const a=Math.max(2,t-1),n=Math.min(s-1,t+1);a>2&&e.push(-1);for(let t=a;t<=n;t++)e.push(t);return n<s-1&&e.push(-2),s>1&&e.push(s),e})().map((e,s)=>e<0?(0,a.jsx)("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700",children:"..."},e):(0,a.jsx)("button",{onClick:()=>n(e),className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold ".concat(e===t?"bg-primary-600 text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0"),"aria-current":e===t?"page":void 0,children:e},e))})}),(0,a.jsx)("button",{onClick:()=>n(t+1),disabled:t===s,className:"relative ml-3 inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})}},9461:(e,t,s)=>{e.exports=s(2330)}}]);
//# sourceMappingURL=126.51ad1969.chunk.js.map