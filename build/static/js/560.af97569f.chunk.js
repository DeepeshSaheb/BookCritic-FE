/*! For license information please see 560.af97569f.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkbook_critic_fe=self.webpackChunkbook_critic_fe||[]).push([[560],{2330:(e,t,n)=>{var o=n(5043);var a="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},i=o.useState,r=o.useEffect,s=o.useLayoutEffect,c=o.useDebugValue;function l(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!a(e,n)}catch(o){return!0}}var d="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),o=i({inst:{value:n,getSnapshot:t}}),a=o[0].inst,d=o[1];return s(function(){a.value=n,a.getSnapshot=t,l(a)&&d({inst:a})},[e,n,t]),r(function(){return l(a)&&d({inst:a}),e(function(){l(a)&&d({inst:a})})},[e]),c(n),n};t.useSyncExternalStore=void 0!==o.useSyncExternalStore?o.useSyncExternalStore:d},2356:(e,t,n)=>{n.d(t,{G:()=>i});var o=n(5043),a=n(579);const i=e=>{let{rating:t=0,maxRating:n=5,size:i="md",color:r="text-yellow-400",readOnly:s=!1,onChange:c,className:l=""}=e;const[d,u]=(0,o.useState)(0),m={sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"};return(0,a.jsx)("div",{className:"flex ".concat(l),onMouseLeave:()=>{s||u(0)},"aria-label":"Rating: ".concat(t," out of ").concat(n),children:Array.from({length:n},(e,o)=>{const l=o+1,v=d?l<=d:l<=t;return(0,a.jsx)("span",{className:"".concat(s?"":"cursor-pointer"),onMouseEnter:()=>{return e=l,void(s||u(e));var e},onClick:()=>{return e=l,void(!s&&c&&c(e));var e},role:s?void 0:"button",tabIndex:s?void 0:0,"aria-label":s?"Rating: ".concat(l," of ").concat(n):"Rate ".concat(l," of ").concat(n),children:v?(0,a.jsx)("svg",{className:"".concat(m[i]," ").concat(r),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}):(0,a.jsx)("svg",{className:"".concat(m[i]," text-gray-300"),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})})},o)})})}},7153:(e,t,n)=>{n.d(t,{C:()=>a});var o=n(6291);const a={getReviews:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return o.A.get("/reviews?skip=".concat(e,"&take=").concat(t))},getBookReviews:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return o.A.get("/reviews/book/".concat(e,"?skip=").concat(t,"&take=").concat(n))},getUserReviews:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return o.A.get("/reviews/user/".concat(e,"?skip=").concat(t,"&take=").concat(n))},getReviewById:async e=>o.A.get("/reviews/".concat(e)),createReview:async e=>o.A.post("/reviews",{bookId:e.bookId,content:e.content,rating:e.rating}),updateReview:async(e,t)=>o.A.patch("/reviews/".concat(e),{content:t.content,rating:t.rating}),deleteReview:async e=>o.A.delete("/reviews/".concat(e)),getAverageRating:async e=>o.A.get("/reviews/book/".concat(e,"/average-rating"))}},8214:(e,t,n)=>{n.r(t),n.d(t,{ReviewEditorPage:()=>w});var o=n(5043),a=n(3216),i=n(5475),r=n(9781),s=n(5604),c=n(2836),l=n(709),d=n(383),u=n(1561),m=n(764),v=n(2356),x=n(579);const g=e=>{let{initialRating:t=0,initialContent:n="",bookTitle:a,isSubmitting:i,error:r,onSubmit:s,onCancel:c}=e;const[l,d]=(0,o.useState)(t),[g,h]=(0,o.useState)(n),[b,w]=(0,o.useState)(""),[y,f]=(0,o.useState)("");return(0,x.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{let e=!0;return 0===l&&(f("Please select a rating"),e=!1),g.trim()?g.trim().length<10&&(w("Review must be at least 10 characters long"),e=!1):(w("Please enter a review"),e=!1),e})()&&s(l,g)},className:"space-y-6",children:[r&&(0,x.jsx)(m.F,{type:"error",className:"mb-4",onClose:()=>{},children:r}),a&&(0,x.jsx)("div",{children:(0,x.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:['Review for "',a,'"']})}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"flex items-center",children:[(0,x.jsx)("label",{htmlFor:"rating",className:"block text-sm font-medium text-gray-700 mr-4",children:"Your Rating"}),(0,x.jsx)(v.G,{rating:l,onChange:e=>{d(e),f("")},size:"lg"})]}),y&&(0,x.jsx)("p",{className:"mt-1 text-sm text-red-600",children:y})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700",children:"Your Review"}),(0,x.jsx)("div",{className:"mt-1",children:(0,x.jsx)("textarea",{id:"content",name:"content",rows:5,value:g,onChange:e=>{h(e.target.value),w("")},placeholder:"Share your thoughts about this book...",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"})}),b&&(0,x.jsx)("p",{className:"mt-1 text-sm text-red-600",children:b}),(0,x.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Be honest and helpful. Your review will help other readers make informed decisions."})]}),(0,x.jsxs)("div",{className:"flex justify-end space-x-3",children:[c&&(0,x.jsx)("button",{type:"button",onClick:c,disabled:i,className:"inline-flex justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:"Cancel"}),(0,x.jsx)("button",{type:"submit",disabled:i,className:"inline-flex justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:i?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(u.y,{size:"sm",color:"text-white",className:"mr-2"}),"Submitting..."]}):n?"Update Review":"Submit Review"})]})]})};var h=n(9256),b=n(7153);const w=()=>{const{bookId:e,reviewId:t}=(0,a.g)(),n=(0,a.Zp)(),v=(0,r.jE)(),[w,y]=(0,o.useState)(""),f=!!t,{data:p,isLoading:k,error:j}=(0,s.I)(["book",e],()=>h.l.getBookById(e),{enabled:!!e&&!f,staleTime:3e5}),{data:N,isLoading:R,error:S}=(0,s.I)(["review",t],()=>b.C.getReviewById(t),{enabled:!!t&&f,staleTime:3e5}),C=(0,c.n)(e=>b.C.createReview({bookId:e.bookId,content:e.content,rating:e.rating}),{onSuccess:t=>{v.invalidateQueries(["bookReviews",e]),v.invalidateQueries(["book",e]),n("/books/".concat(e))},onError:e=>{y((null===e||void 0===e?void 0:e.message)||"Failed to create review. Please try again.")}}),I=(0,c.n)(e=>b.C.updateReview(e.id,{content:e.content,rating:e.rating}),{onSuccess:e=>{v.invalidateQueries(["bookReviews",null===N||void 0===N?void 0:N.book.id]),v.invalidateQueries(["review",t]),v.invalidateQueries(["book",null===N||void 0===N?void 0:N.book.id]),n("/books/".concat(null===N||void 0===N?void 0:N.book.id))},onError:e=>{y((null===e||void 0===e?void 0:e.message)||"Failed to update review. Please try again.")}}),E=f&&S||!f&&j;return f&&R||!f&&k?(0,x.jsx)(l.P,{children:(0,x.jsx)(d.m,{className:"py-12",children:(0,x.jsx)("div",{className:"flex justify-center",children:(0,x.jsx)(u.y,{size:"lg"})})})}):E?(0,x.jsx)(l.P,{children:(0,x.jsxs)(d.m,{className:"py-12",children:[(0,x.jsx)(m.F,{type:"error",children:f?"Failed to load review. Please try again later.":"Failed to load book details. Please try again later."}),(0,x.jsx)("div",{className:"mt-6 text-center",children:(0,x.jsx)(i.N_,{to:f&&N?"/books/".concat(N.book.id):"/books",className:"text-primary-600 hover:text-primary-500",children:"Go back"})})]})}):f&&!N?(0,x.jsx)(l.P,{children:(0,x.jsxs)(d.m,{className:"py-12",children:[(0,x.jsx)(m.F,{type:"error",children:"Review not found."}),(0,x.jsx)("div",{className:"mt-6 text-center",children:(0,x.jsx)(i.N_,{to:"/books",className:"text-primary-600 hover:text-primary-500",children:"Browse books"})})]})}):f||p?(0,x.jsx)(l.P,{children:(0,x.jsx)(d.m,{className:"py-8",children:(0,x.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,x.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:f?"Edit Review":"Write a Review"}),(0,x.jsx)("div",{className:"mt-8",children:(0,x.jsx)(g,{initialRating:f?null===N||void 0===N?void 0:N.rating:0,initialContent:f?null===N||void 0===N?void 0:N.content:"",bookTitle:f?null===N||void 0===N?void 0:N.book.title:null===p||void 0===p?void 0:p.title,isSubmitting:C.isLoading||I.isLoading,error:w,onSubmit:(n,o)=>{f&&t?I.mutate({id:t,content:o,rating:n}):e&&C.mutate({bookId:e,content:o,rating:n})},onCancel:()=>{n(f&&N?"/books/".concat(N.book.id):e?"/books/".concat(e):"/")}})})]})})}):(0,x.jsx)(l.P,{children:(0,x.jsxs)(d.m,{className:"py-12",children:[(0,x.jsx)(m.F,{type:"error",children:"Book not found."}),(0,x.jsx)("div",{className:"mt-6 text-center",children:(0,x.jsx)(i.N_,{to:"/books",className:"text-primary-600 hover:text-primary-500",children:"Browse books"})})]})})}},9461:(e,t,n)=>{e.exports=n(2330)}}]);
//# sourceMappingURL=560.af97569f.chunk.js.map