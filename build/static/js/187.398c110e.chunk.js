/*! For license information please see 187.398c110e.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkbook_critic_fe=self.webpackChunkbook_critic_fe||[]).push([[187],{2330:(e,t,s)=>{var i=s(5043);var a="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},r=i.useState,n=i.useEffect,o=i.useLayoutEffect,c=i.useDebugValue;function l(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!a(e,s)}catch(i){return!0}}var d="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var s=t(),i=r({inst:{value:s,getSnapshot:t}}),a=i[0].inst,d=i[1];return o(function(){a.value=s,a.getSnapshot=t,l(a)&&d({inst:a})},[e,s,t]),n(function(){return l(a)&&d({inst:a}),e(function(){l(a)&&d({inst:a})})},[e]),c(s),s};t.useSyncExternalStore=void 0!==i.useSyncExternalStore?i.useSyncExternalStore:d},2356:(e,t,s)=>{s.d(t,{G:()=>r});var i=s(5043),a=s(579);const r=e=>{let{rating:t=0,maxRating:s=5,size:r="md",color:n="text-yellow-400",readOnly:o=!1,onChange:c,className:l=""}=e;const[d,m]=(0,i.useState)(0),x={sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"};return(0,a.jsx)("div",{className:"flex ".concat(l),onMouseLeave:()=>{o||m(0)},"aria-label":"Rating: ".concat(t," out of ").concat(s),children:Array.from({length:s},(e,i)=>{const l=i+1,u=d?l<=d:l<=t;return(0,a.jsx)("span",{className:"".concat(o?"":"cursor-pointer"),onMouseEnter:()=>{return e=l,void(o||m(e));var e},onClick:()=>{return e=l,void(!o&&c&&c(e));var e},role:o?void 0:"button",tabIndex:o?void 0:0,"aria-label":o?"Rating: ".concat(l," of ").concat(s):"Rate ".concat(l," of ").concat(s),children:u?(0,a.jsx)("svg",{className:"".concat(x[r]," ").concat(n),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}):(0,a.jsx)("svg",{className:"".concat(x[r]," text-gray-300"),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})})},i)})})}},3567:(e,t,s)=>{s.r(t),s.d(t,{BookDetailPage:()=>j});var i=s(5043),a=s(3216),r=s(5475),n=s(5604),o=s(9781),c=s(2836),l=s(709),d=s(383),m=s(2356),x=s(1561),u=s(764),g=s(8964),h=s(684),v=s(9256),f=s(7153),y=s(8526),p=s(579);const j=()=>{var e;const{id:t}=(0,a.g)(),{isAuthenticated:s,user:j}=(0,h.A)(),[b,w]=(0,i.useState)(1),N=(0,o.jE)(),[k,R]=(0,i.useState)(!1),{data:L,isLoading:S,error:C}=(0,n.I)(["book",t],()=>v.l.getBookById(t),{enabled:!!t,staleTime:3e5}),{data:P,isLoading:A}=(0,n.I)(["readingList",t],()=>y.D.getReadingList(0,100),{enabled:!!t&&s,staleTime:3e5,onSuccess:e=>{const s=e.books.some(e=>e.id===t);R(s)}}),z=(0,c.n)(()=>y.D.addToReadingList(t),{onSuccess:()=>{R(!0),N.invalidateQueries(["readingList"])},onError:e=>{alert((null===e||void 0===e?void 0:e.message)||"Failed to add book to reading list. Please try again.")}}),B=(0,c.n)(()=>y.D.removeFromReadingList(t),{onSuccess:()=>{R(!1),N.invalidateQueries(["readingList"])},onError:e=>{alert((null===e||void 0===e?void 0:e.message)||"Failed to remove book from reading list. Please try again.")}}),{data:D,isLoading:E,error:I}=(0,n.I)(["bookReviews",t,b],()=>f.C.getBookReviews(t,5*(b-1),5),{enabled:!!t,keepPreviousData:!0,staleTime:3e5}),F=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown";return S?(0,p.jsx)(l.P,{children:(0,p.jsx)(d.m,{className:"py-12",children:(0,p.jsx)("div",{className:"flex justify-center",children:(0,p.jsx)(x.y,{size:"lg"})})})}):C?(0,p.jsx)(l.P,{children:(0,p.jsx)(d.m,{className:"py-12",children:(0,p.jsx)(u.F,{type:"error",children:"Failed to load book details. Please try again later."})})}):L?(0,p.jsx)(l.P,{children:(0,p.jsxs)(d.m,{className:"py-8",children:[(0,p.jsxs)("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-3",children:[(0,p.jsxs)("div",{className:"md:col-span-1",children:[(0,p.jsx)("div",{className:"aspect-w-2 aspect-h-3 overflow-hidden rounded-lg",children:(0,p.jsx)("img",{src:L.coverImageUrl||"https://via.placeholder.com/300x450?text=No+Cover",alt:L.title,className:"h-full w-full object-cover object-center"})}),s&&(0,p.jsxs)("div",{className:"mt-6 space-y-3",children:[(0,p.jsx)("button",{type:"button",onClick:()=>{k?window.confirm("Are you sure you want to remove this book from your reading list?")&&B.mutate():z.mutate()},disabled:z.isLoading||B.isLoading,className:"w-full flex justify-center items-center px-4 py-2 border rounded-md shadow-sm text-sm font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 ".concat(k?"border-red-300 text-red-700 bg-red-50 hover:bg-red-100":"border-transparent text-white bg-primary-600 hover:bg-primary-700"),children:z.isLoading||B.isLoading?(0,p.jsxs)("span",{className:"inline-flex items-center",children:[(0,p.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,p.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,p.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):k?"Remove from Reading List":"Add to Reading List"}),(0,p.jsx)(r.N_,{to:"/books/".concat(L.id,"/review"),className:"w-full flex justify-center items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Write a Review"})]})]}),(0,p.jsxs)("div",{className:"md:col-span-2",children:[(0,p.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl",children:L.title}),(0,p.jsxs)("p",{className:"mt-2 text-lg text-gray-600",children:["by ",L.author]}),(0,p.jsxs)("div",{className:"mt-4 flex items-center",children:[(0,p.jsx)(m.G,{rating:L.averageRating||0,readOnly:!0,size:"md"}),(0,p.jsxs)("span",{className:"ml-2 text-sm text-gray-500",children:[(null===(e=L.averageRating)||void 0===e?void 0:e.toFixed(1))||"No ratings"," (",L.totalReviews," ",1===L.totalReviews?"review":"reviews",")"]})]}),L.isbn&&(0,p.jsxs)("p",{className:"mt-2 text-sm text-gray-500",children:["ISBN: ",L.isbn]}),L.publishedDate&&(0,p.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:["Published: ",F(L.publishedDate)]}),L.genres&&L.genres.length>0&&(0,p.jsxs)("div",{className:"mt-4",children:[(0,p.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Genres"}),(0,p.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:L.genres.map(e=>(0,p.jsx)("span",{className:"inline-flex items-center rounded-full bg-primary-100 px-3 py-0.5 text-sm font-medium text-primary-800",children:e},e))})]}),L.description&&(0,p.jsxs)("div",{className:"mt-6",children:[(0,p.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Description"}),(0,p.jsx)("div",{className:"mt-2 space-y-4 text-base text-gray-600",children:(0,p.jsx)("p",{children:L.description})})]})]})]}),(0,p.jsxs)("div",{id:"reviews",className:"mt-16 border-t border-gray-200 pt-10",children:[(0,p.jsx)("h2",{className:"text-2xl font-bold tracking-tight text-gray-900",children:"Reviews"}),s&&(0,p.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,p.jsx)("p",{className:"text-sm text-gray-500",children:"Share your thoughts with other readers."}),(0,p.jsx)(r.N_,{to:"/books/".concat(L.id,"/review"),className:"flex items-center justify-center rounded-md border border-transparent bg-primary-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:"Write a Review"})]}),(0,p.jsx)("div",{className:"mt-6",children:E?(0,p.jsx)("div",{className:"flex justify-center py-12",children:(0,p.jsx)(x.y,{size:"md"})}):I?(0,p.jsx)(u.F,{type:"error",children:"Failed to load reviews. Please try again later."}):D&&D.reviews.length>0?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"flow-root",children:(0,p.jsx)("div",{className:"-my-6 divide-y divide-gray-200",children:D.reviews.map(e=>(0,p.jsxs)("div",{className:"border-b border-gray-200 py-6 last:border-b-0",children:[(0,p.jsxs)("div",{className:"flex items-center justify-between",children:[(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"mr-4 h-10 w-10 flex-shrink-0 rounded-full bg-gray-200 flex items-center justify-center",children:(0,p.jsx)("span",{className:"text-gray-500 font-medium",children:e.user.displayName.charAt(0).toUpperCase()})}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:e.user.displayName}),(0,p.jsxs)("div",{className:"mt-1 flex items-center",children:[(0,p.jsx)(m.G,{rating:e.rating,readOnly:!0,size:"sm"}),(0,p.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:F(e.createdAt)})]})]})]}),s&&(null===j||void 0===j?void 0:j.id)===e.user.id&&(0,p.jsxs)("div",{className:"flex space-x-2",children:[(0,p.jsx)(r.N_,{to:"/reviews/".concat(e.id,"/edit"),className:"text-sm font-medium text-primary-600 hover:text-primary-500",children:"Edit"}),(0,p.jsx)("button",{className:"text-sm font-medium text-red-600 hover:text-red-500",onClick:()=>{},children:"Delete"})]})]}),(0,p.jsx)("div",{className:"mt-4 space-y-6 text-sm text-gray-600",children:(0,p.jsx)("p",{children:e.content})})]},e.id))})}),D.total>5&&(0,p.jsx)("div",{className:"mt-8 flex justify-center",children:(0,p.jsx)(g.d,{currentPage:b,totalPages:Math.ceil(D.total/5),onPageChange:e=>{var t;w(e),window.scrollTo({top:(null===(t=document.getElementById("reviews"))||void 0===t?void 0:t.offsetTop)||0,behavior:"smooth"})}})})]}):(0,p.jsx)("div",{className:"py-12 text-center text-gray-500",children:"No reviews yet. Be the first to review this book!"})})]})]})}):(0,p.jsx)(l.P,{children:(0,p.jsx)(d.m,{className:"py-12",children:(0,p.jsx)(u.F,{type:"error",children:"Book not found."})})})}},7153:(e,t,s)=>{s.d(t,{C:()=>a});var i=s(6291);const a={getReviews:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return i.A.get("/reviews?skip=".concat(e,"&take=").concat(t))},getBookReviews:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return i.A.get("/reviews/book/".concat(e,"?skip=").concat(t,"&take=").concat(s))},getUserReviews:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return i.A.get("/reviews/user/".concat(e,"?skip=").concat(t,"&take=").concat(s))},getReviewById:async e=>i.A.get("/reviews/".concat(e)),createReview:async e=>i.A.post("/reviews",{bookId:e.bookId,content:e.content,rating:e.rating}),updateReview:async(e,t)=>i.A.patch("/reviews/".concat(e),{content:t.content,rating:t.rating}),deleteReview:async e=>i.A.delete("/reviews/".concat(e)),getAverageRating:async e=>i.A.get("/reviews/book/".concat(e,"/average-rating"))}},8964:(e,t,s)=>{s.d(t,{d:()=>a});s(5043);var i=s(579);const a=e=>{let{currentPage:t,totalPages:s,onPageChange:a,className:r=""}=e;if(s<=1)return null;return(0,i.jsxs)("nav",{className:"flex items-center justify-between border-t border-gray-200 px-4 sm:px-0 py-3 ".concat(r),"aria-label":"Pagination",children:[(0,i.jsx)("div",{className:"hidden sm:block",children:(0,i.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing page ",(0,i.jsx)("span",{className:"font-medium",children:t})," of"," ",(0,i.jsx)("span",{className:"font-medium",children:s})]})}),(0,i.jsxs)("div",{className:"flex flex-1 justify-between sm:justify-end",children:[(0,i.jsx)("button",{onClick:()=>a(t-1),disabled:1===t,className:"relative inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,i.jsx)("div",{className:"hidden sm:flex sm:items-center",children:(0,i.jsx)("div",{className:"flex items-center space-x-1",children:(()=>{const e=[];e.push(1);const i=Math.max(2,t-1),a=Math.min(s-1,t+1);i>2&&e.push(-1);for(let t=i;t<=a;t++)e.push(t);return a<s-1&&e.push(-2),s>1&&e.push(s),e})().map((e,s)=>e<0?(0,i.jsx)("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700",children:"..."},e):(0,i.jsx)("button",{onClick:()=>a(e),className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold ".concat(e===t?"bg-primary-600 text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0"),"aria-current":e===t?"page":void 0,children:e},e))})}),(0,i.jsx)("button",{onClick:()=>a(t+1),disabled:t===s,className:"relative ml-3 inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})}},9461:(e,t,s)=>{e.exports=s(2330)}}]);
//# sourceMappingURL=187.398c110e.chunk.js.map