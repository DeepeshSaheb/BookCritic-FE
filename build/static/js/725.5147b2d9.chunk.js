/*! For license information please see 725.5147b2d9.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkbook_critic_fe=self.webpackChunkbook_critic_fe||[]).push([[725],{2330:(e,t,s)=>{var r=s(5043);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},a=r.useState,n=r.useEffect,o=r.useLayoutEffect,l=r.useDebugValue;function d(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!i(e,s)}catch(r){return!0}}var c="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var s=t(),r=a({inst:{value:s,getSnapshot:t}}),i=r[0].inst,c=r[1];return o(function(){i.value=s,i.getSnapshot=t,d(i)&&c({inst:i})},[e,s,t]),n(function(){return d(i)&&c({inst:i}),e(function(){d(i)&&c({inst:i})})},[e]),l(s),s};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:c},7249:(e,t,s)=>{s.r(t),s.d(t,{AdminBooksPage:()=>g});var r=s(2555),i=s(5043),a=s(5604),n=s(9781),o=s(2836),l=s(709),d=s(383),c=s(1561),m=s(764),u=s(8964),x=s(684),p=s(9256),h=s(579);const g=()=>{const{isAdmin:e}=(0,x.A)(),t=(0,n.jE)(),[s,g]=(0,i.useState)(1),[f,b]=(0,i.useState)(!1),[y,v]=(0,i.useState)(null),[j,w]=(0,i.useState)({title:"",author:"",isbn:"",description:"",publishedDate:"",coverImageUrl:"",genres:[]}),[N,k]=(0,i.useState)(""),{data:C,isLoading:S,error:D}=(0,a.I)(["adminBooks",s],()=>p.l.getBooks(10*(s-1),10),{keepPreviousData:!0,staleTime:3e5}),P=(0,o.n)(e=>p.l.createBook(e),{onSuccess:()=>{t.invalidateQueries(["adminBooks"]),B(),b(!1)},onError:e=>{k((null===e||void 0===e?void 0:e.message)||"Failed to create book. Please try again.")}}),F=(0,o.n)(e=>p.l.updateBook(e.id,e),{onSuccess:()=>{t.invalidateQueries(["adminBooks"]),B(),b(!1)},onError:e=>{k((null===e||void 0===e?void 0:e.message)||"Failed to update book. Please try again.")}}),A=(0,o.n)(e=>p.l.deleteBook(e),{onSuccess:()=>{t.invalidateQueries(["adminBooks"])},onError:e=>{alert((null===e||void 0===e?void 0:e.message)||"Failed to delete book. Please try again.")}}),B=()=>{w({title:"",author:"",isbn:"",description:"",publishedDate:"",coverImageUrl:"",genres:[]}),v(null),k("")},I=e=>{const{name:t,value:s}=e.target;w(e=>(0,r.A)((0,r.A)({},e),{},{[t]:s}))},E=e=>e?new Date(e).toISOString().split("T")[0]:"";return e?(0,h.jsx)(l.P,{children:(0,h.jsxs)(d.m,{className:"py-8",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center",children:[(0,h.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Book Management"}),(0,h.jsx)("button",{type:"button",onClick:()=>{B(),b(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Add New Book"})]}),(0,h.jsx)("div",{className:"mt-8 flex flex-col",children:(0,h.jsx)("div",{className:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8",children:(0,h.jsx)("div",{className:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8",children:(0,h.jsx)("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",children:S?(0,h.jsx)("div",{className:"flex justify-center py-12",children:(0,h.jsx)(c.y,{size:"lg"})}):D?(0,h.jsx)("div",{className:"p-6",children:(0,h.jsx)(m.F,{type:"error",children:"Failed to load books. Please try again later."})}):C&&C.books.length>0?(0,h.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[(0,h.jsx)("thead",{className:"bg-gray-50",children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6",children:"Title"}),(0,h.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Author"}),(0,h.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"ISBN"}),(0,h.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Published Date"}),(0,h.jsx)("th",{scope:"col",className:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900",children:"Rating"}),(0,h.jsx)("th",{scope:"col",className:"relative py-3.5 pl-3 pr-4 sm:pr-6",children:(0,h.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),(0,h.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:C.books.map(e=>{var t;return(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6",children:e.title}),(0,h.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.author}),(0,h.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.isbn||"-"}),(0,h.jsx)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e.publishedDate?E(e.publishedDate):"-"}),(0,h.jsxs)("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:[(null===(t=e.averageRating)||void 0===t?void 0:t.toFixed(1))||"-"," (",e.totalReviews||0,")"]}),(0,h.jsxs)("td",{className:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6",children:[(0,h.jsx)("button",{onClick:()=>(e=>{v(e),w({id:e.id,title:e.title,author:e.author,isbn:e.isbn||"",description:e.description||"",publishedDate:e.publishedDate||"",coverImageUrl:e.coverImageUrl||"",genres:e.genres||[]}),b(!0)})(e),className:"text-primary-600 hover:text-primary-900 mr-4",children:"Edit"}),(0,h.jsx)("button",{onClick:()=>{return t=e.id,void(window.confirm("Are you sure you want to delete this book? This action cannot be undone.")&&A.mutate(t));var t},className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},e.id)})})]}):(0,h.jsx)("div",{className:"p-6 text-center text-gray-500",children:"No books found. Add a new book to get started."})})})})}),C&&C.total>10&&(0,h.jsx)("div",{className:"mt-6 flex justify-center",children:(0,h.jsx)(u.d,{currentPage:s,totalPages:Math.ceil(C.total/10),onPageChange:e=>{g(e)}})}),f&&(0,h.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,h.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,h.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>b(!1)}),(0,h.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),(0,h.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",children:(0,h.jsx)("div",{className:"sm:flex sm:items-start",children:(0,h.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[(0,h.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:y?"Edit Book":"Add New Book"}),N&&(0,h.jsx)(m.F,{type:"error",className:"mt-4",onClose:()=>k(""),children:N}),(0,h.jsxs)("form",{onSubmit:e=>{e.preventDefault(),k(""),j.title.trim()?j.author.trim()?y?F.mutate(j):P.mutate(j):k("Author is required"):k("Title is required")},className:"mt-6 space-y-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Title *"}),(0,h.jsx)("input",{type:"text",name:"title",id:"title",value:j.title,onChange:I,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{htmlFor:"author",className:"block text-sm font-medium text-gray-700",children:"Author *"}),(0,h.jsx)("input",{type:"text",name:"author",id:"author",value:j.author,onChange:I,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{htmlFor:"isbn",className:"block text-sm font-medium text-gray-700",children:"ISBN"}),(0,h.jsx)("input",{type:"text",name:"isbn",id:"isbn",value:j.isbn,onChange:I,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{htmlFor:"publishedDate",className:"block text-sm font-medium text-gray-700",children:"Published Date"}),(0,h.jsx)("input",{type:"date",name:"publishedDate",id:"publishedDate",value:j.publishedDate?E(j.publishedDate):"",onChange:I,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{htmlFor:"coverImageUrl",className:"block text-sm font-medium text-gray-700",children:"Cover Image URL"}),(0,h.jsx)("input",{type:"url",name:"coverImageUrl",id:"coverImageUrl",value:j.coverImageUrl,onChange:I,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{htmlFor:"genres",className:"block text-sm font-medium text-gray-700",children:"Genres (comma separated)"}),(0,h.jsx)("input",{type:"text",name:"genres",id:"genres",value:j.genres.join(", "),onChange:e=>{const t=e.target.value.split(",").map(e=>e.trim());w(e=>(0,r.A)((0,r.A)({},e),{},{genres:t}))},className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,h.jsx)("textarea",{name:"description",id:"description",rows:4,value:j.description,onChange:I,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"})]}),(0,h.jsxs)("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[(0,h.jsx)("button",{type:"submit",disabled:P.isLoading||F.isLoading,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:P.isLoading||F.isLoading?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.y,{size:"sm",color:"text-white",className:"mr-2"}),y?"Updating...":"Creating..."]}):y?"Update":"Create"}),(0,h.jsx)("button",{type:"button",onClick:()=>b(!1),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})})]})})]})}):(0,h.jsx)(l.P,{children:(0,h.jsx)(d.m,{className:"py-12",children:(0,h.jsx)(m.F,{type:"error",children:"You do not have permission to access this page."})})})}},8964:(e,t,s)=>{s.d(t,{d:()=>i});s(5043);var r=s(579);const i=e=>{let{currentPage:t,totalPages:s,onPageChange:i,className:a=""}=e;if(s<=1)return null;return(0,r.jsxs)("nav",{className:"flex items-center justify-between border-t border-gray-200 px-4 sm:px-0 py-3 ".concat(a),"aria-label":"Pagination",children:[(0,r.jsx)("div",{className:"hidden sm:block",children:(0,r.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing page ",(0,r.jsx)("span",{className:"font-medium",children:t})," of"," ",(0,r.jsx)("span",{className:"font-medium",children:s})]})}),(0,r.jsxs)("div",{className:"flex flex-1 justify-between sm:justify-end",children:[(0,r.jsx)("button",{onClick:()=>i(t-1),disabled:1===t,className:"relative inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,r.jsx)("div",{className:"hidden sm:flex sm:items-center",children:(0,r.jsx)("div",{className:"flex items-center space-x-1",children:(()=>{const e=[];e.push(1);const r=Math.max(2,t-1),i=Math.min(s-1,t+1);r>2&&e.push(-1);for(let t=r;t<=i;t++)e.push(t);return i<s-1&&e.push(-2),s>1&&e.push(s),e})().map((e,s)=>e<0?(0,r.jsx)("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700",children:"..."},e):(0,r.jsx)("button",{onClick:()=>i(e),className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold ".concat(e===t?"bg-primary-600 text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0"),"aria-current":e===t?"page":void 0,children:e},e))})}),(0,r.jsx)("button",{onClick:()=>i(t+1),disabled:t===s,className:"relative ml-3 inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})}},9461:(e,t,s)=>{e.exports=s(2330)}}]);
//# sourceMappingURL=725.5147b2d9.chunk.js.map